<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Math AI for Class 6 | Svaraikyam AI</title>

    <!-- Site-wide Styles and Fonts -->
    <link rel="stylesheet" href="style.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css"
    />

    <!-- Tailwind CSS for the Quiz Component -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Inter Font for the Quiz Component -->
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <!-- Inline Styles for the Quiz Component -->
    <style>
      /* Styles for the quiz, scoped to the quiz container */
      #quiz-section {
        font-family: "Inter", sans-serif;
        background-color: #f0f4f8; /* A light blue-gray background */
      }
      .option-btn {
        transition: all 0.2s ease-in-out;
      }
      .option-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      }
      .correct {
        background-color: #22c55e !important; /* green-500 */
        color: white !important;
        border-color: #16a34a !important; /* green-600 */
      }
      .incorrect {
        background-color: #ef4444 !important; /* red-500 */
        color: white !important;
        border-color: #dc2626 !important; /* red-600 */
      }
      #loader {
        border: 5px solid #f3f3f3;
        border-top: 5px solid #3b82f6;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        animation: spin 1s linear infinite;
      }
      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }
    </style>
  </head>
  <body>
    <!-- Header and Navigation Bar -->
    <header>
      <nav class="container">
        <a href="index.html" class="logo">
          <img
            src="company_logo.png"
            alt="Svaraikyam AI Logo"
            onerror="this.onerror=null; this.src='https://placehold.co/100x50/e6f2ff/007bff?text=Logo';"
          />
          <span>Svaraikyam AI</span>
        </a>
        <ul class="nav-links">
          <li><a href="index.html">Home</a></li>
          <li class="dropdown">
            <a href="products.html" class="dropbtn"
              >Products <i class="fas fa-caret-down"></i
            ></a>
            <div class="dropdown-content">
              <a href="smartpurchase-details.html">SmartPurchase</a>
              <a href="product-voice-llm.html">Voice LLM</a>
              <a href="product-virtual-sales-agent.html">Virtual Sales Agent</a>
            </div>
          </li>
          <li class="dropdown">
            <a href="blogs.html" class="dropbtn"
              >Blogs <i class="fas fa-caret-down"></i
            ></a>
            <div class="dropdown-content">
              <a href="blog-basics-deep-learning.html"
                >Basics of Deep Learning</a
              >
              <a href="blog-ai-skills-students.html">AI Skills for Students</a>
              <a href="blog-ai-skills-undergraduates.html"
                >AI Skills for Undergraduates</a
              >
              <a href="blog-ai-skills-engineers.html"
                >AI Skills for Engineering Professionals</a
              >
            </div>
          </li>
          <li class="dropdown">
            <a href="services.html" class="dropbtn"
              >Services <i class="fas fa-caret-down"></i
            ></a>
            <div class="dropdown-content">
              <a href="service-android-ar-vr.html"
                >Android App Dev with AR/VR</a
              >
              <a href="service-android-gen-ai.html"
                >Android App Dev with GenAI</a
              >
              <a href="service-android-cv.html">Android App Dev with CV</a>
              <a href="service-llm-cuda.html"
                >LLM Training Optimization with CUDA</a
              >
              <a href="service-ai-model-migration.html"
                >AI Model Migration to Production</a
              >
              <a href="service-data-annotation.html">Data Annotation</a>
            </div>
          </li>
          <li><a href="about.html">About Us</a></li>
          <li><a href="contact.html">Contact</a></li>
        </ul>
      </nav>
    </header>

    <main>
      <section id="quiz-section">
        <div class="container mx-auto py-12">
          <div class="w-full max-w-2xl mx-auto">
            <div class="bg-white rounded-2xl shadow-lg p-6 md:p-8">
              <h1
                class="text-2xl md:text-3xl font-bold text-center text-gray-800 mb-2"
              >
                Math Patterns Quiz
              </h1>
              <p class="text-center text-gray-500 mb-6">
                AI-Generated Questions for Grade 6
              </p>

              <div id="quiz-container" class="space-y-6">
                <div
                  id="question-area"
                  class="text-center p-5 bg-blue-50 border-2 border-blue-200 rounded-lg min-h-[120px] flex items-center justify-center"
                >
                  <div id="loader"></div>
                  <p
                    id="question-text"
                    class="text-xl font-medium text-gray-700 hidden"
                  ></p>
                </div>

                <div
                  id="options-grid"
                  class="grid grid-cols-1 md:grid-cols-2 gap-4"
                >
                  <!-- Options will be dynamically inserted here -->
                </div>

                <div
                  id="feedback-area"
                  class="text-center text-lg font-medium p-3 rounded-lg hidden"
                ></div>

                <button
                  id="next-question-btn"
                  class="w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-4 focus:ring-blue-300 transition-all duration-300 shadow-md hidden"
                >
                  Next Question
                </button>
              </div>
            </div>
            <footer class="text-center mt-4 text-gray-400 text-sm">
              <p>Powered by AI. Based on "Patterns in Mathematics" concepts.</p>
            </footer>
          </div>
        </div>
      </section>
    </main>

    <!-- Footer -->
    <footer>
      <div class="container">
        <p>&copy; 2025 Svaraikyam AI. All Rights Reserved.</p>
      </div>
    </footer>

    <script>
      // --- DOM Elements ---
      const questionArea = document.getElementById("question-area");
      const questionText = document.getElementById("question-text");
      const optionsGrid = document.getElementById("options-grid");
      const feedbackArea = document.getElementById("feedback-area");
      const nextButton = document.getElementById("next-question-btn");
      const loader = document.getElementById("loader");

      // --- State ---
      let currentQuestion = null;
      let correctAnswer = null;
      let isAnswered = false;

      // --- Pattern Types from the PDF ---
      const patternTypes = [
        "consecutive odd numbers",
        "consecutive even numbers",
        "triangular numbers (1, 3, 6, 10...)",
        "square numbers (1, 4, 9, 16...)",
        "cube numbers (1, 8, 27, 64...)",
        "powers of 2",
        "VirahÄnka numbers (Fibonacci sequence)",
        "the relationship between adding odd numbers and square numbers",
      ];

      // --- Main Functions ---

      /**
       * Fetches a new question from the AI model.
       */
      async function getNewQuestion() {
        // 1. Reset UI
        resetUI();

        // 2. Select a random pattern
        const randomPattern =
          patternTypes[Math.floor(Math.random() * patternTypes.length)];

        // 3. Create a prompt for the AI
        const prompt = `
                Generate a multiple-choice math quiz question for a 6th-grade student based on the concept of "${randomPattern}".
                The question should be challenging but solvable.
                Provide a question statement, four options (one correct, three plausible incorrect), and identify the correct answer.
                Format the output as a JSON object with the keys: "question", "options" (an array of numbers or strings), and "answer".
                Ensure the options are distinct. For sequence questions, the question should present the first 4 or 5 terms.
                Example for triangular numbers:
                {
                  "question": "The sequence 1, 3, 6, 10, 15,... represents triangular numbers. What is the next number in this sequence?",
                  "options": [21, 20, 25, 18],
                  "answer": 21
                }
            `;

        // 4. Call the AI model
        try {
          const result = await callGemini(prompt);
          currentQuestion = result;
          correctAnswer = result.answer;
          displayQuestion(result);
        } catch (error) {
          console.error("Error fetching question:", error);
          // The error message will now be displayed by callGemini if the API key is missing.
        }
      }

      /**
       * Calls the Gemini API with a given prompt and schema.
       */
      async function callGemini(prompt) {
        // IMPORTANT: Paste your Google AI Studio API key in the quotes below.
        const apiKey = "AIzaSyC6rNEPO-OuGXIQaPSLpkqBJGmsA2L_-nk";

        // Check if the API key has been replaced.
        if (apiKey === "PASTE_YOUR_API_KEY_HERE") {
          questionText.textContent =
            "API Key not set. Please add your Google AI Studio API key to the script.";
          loader.classList.add("hidden");
          questionText.classList.remove("hidden");
          throw new Error("API Key not set.");
        }

        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

        const payload = {
          contents: [{ role: "user", parts: [{ text: prompt }] }],
        };

        const response = await fetch(apiUrl, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(payload),
        });

        if (!response.ok) {
          throw new Error(`API call failed with status: ${response.status}`);
        }

        const result = await response.json();

        if (
          result.candidates &&
          result.candidates.length > 0 &&
          result.candidates[0].content &&
          result.candidates[0].content.parts &&
          result.candidates[0].content.parts.length > 0
        ) {
          let textResponse = result.candidates[0].content.parts[0].text;

          // CORRECTED: Clean the response to remove Markdown formatting before parsing.
          if (textResponse.startsWith("```json")) {
            textResponse = textResponse.slice(7, -3).trim();
          } else if (textResponse.startsWith("```")) {
            textResponse = textResponse.slice(3, -3).trim();
          }

          try {
            return JSON.parse(textResponse);
          } catch (e) {
            console.error("Failed to parse JSON from response:", textResponse);
            throw new Error("Could not parse the question data from the AI.");
          }
        } else {
          throw new Error("Invalid response structure from API.");
        }
      }

      /**
       * Displays the question and options on the screen.
       * @param {object} data - The question data from the AI.
       */
      function displayQuestion(data) {
        loader.classList.add("hidden");
        questionText.textContent = data.question;
        questionText.classList.remove("hidden");

        const shuffledOptions = data.options.sort(() => Math.random() - 0.5);

        shuffledOptions.forEach((option) => {
          const button = document.createElement("button");
          button.className =
            "option-btn w-full text-left p-4 bg-white border-2 border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-50 hover:border-blue-400";
          button.textContent = option;
          button.onclick = () => handleOptionClick(button, option);
          optionsGrid.appendChild(button);
        });
      }

      /**
       * Handles the logic when a user clicks an option.
       * @param {HTMLElement} buttonEl - The button element that was clicked.
       * @param {string|number} selectedOption - The value of the selected option.
       */
      function handleOptionClick(buttonEl, selectedOption) {
        if (isAnswered) return;
        isAnswered = true;

        const isCorrect = String(selectedOption) === String(correctAnswer);

        feedbackArea.classList.remove("hidden");
        if (isCorrect) {
          buttonEl.classList.add("correct");
          feedbackArea.textContent = "Correct! Well done.";
          feedbackArea.className =
            "text-center text-lg font-medium p-3 rounded-lg text-green-700 bg-green-100";
        } else {
          buttonEl.classList.add("incorrect");
          feedbackArea.textContent = `Not quite. The correct answer is ${correctAnswer}.`;
          feedbackArea.className =
            "text-center text-lg font-medium p-3 rounded-lg text-red-700 bg-red-100";

          const allButtons = optionsGrid.querySelectorAll("button");
          allButtons.forEach((btn) => {
            if (String(btn.textContent) === String(correctAnswer)) {
              btn.classList.add("correct");
            }
          });
        }

        nextButton.classList.remove("hidden");
      }

      /**
       * Resets the UI for the next question.
       */
      function resetUI() {
        loader.classList.remove("hidden");
        questionText.classList.add("hidden");
        questionText.textContent = "";
        optionsGrid.innerHTML = "";
        feedbackArea.classList.add("hidden");
        feedbackArea.textContent = "";
        nextButton.classList.add("hidden");
        isAnswered = false;
      }

      // --- Event Listeners ---
      nextButton.addEventListener("click", getNewQuestion);

      // --- Initial Load ---
      window.onload = getNewQuestion;
    </script>
    <script src="app.js"></script>
  </body>
</html>
